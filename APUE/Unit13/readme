#13 守护进程daemon -- 是一种长期生存的进程，执行日常事务活动
守护进程结构  编写守护进程  以及守护进程如何报告出错情况

##1 守护进程特征
命令：ps -axj  -a显示由其他用户所拥有的进程状态 -x没有控制终端的进程状态 -j显示与作业有关信息
####A 系统进程实现依赖操作系统实现。父进程ID为0的各进程通常是内核进程
####B 守护进程的名字在[]中
Linux中：
1) kthread特殊内核进程来创建其它内核进程。对于需要在进程上下文执行工作但却不被用户层进程上下调用的每一个内核组件，通常有它自己的内核守护进程。
2) kswapd--内存换页守护进程
3) fflush守护进程可以在用内存达到设置的最小阈值时将脏页面冲洗
4) sync_supers 定期将文件系统元数据冲洗至磁盘
5) jbd守护进程帮助实现了ext4文件系统中的日志功能
6) rpcbind rsyslogd inetd cron ssd cupsd atd ......

##2 编程规则
1) 调用umask将文件模式创建屏蔽字设置为已知值
2) 调用fork，然后exit父进程。A 父进程终止，会让shell认为启动守护进程命令执行完毕；C 子进程不是一个进程组的组长进程，是调用setsid的先决条件
3) 调用setsid创建新一个会话。使调用进程：成为新会话的首进程；成为一个新进程组的组长进程； 没有控制终端
4) 将当前工作目录改为根目录
5) 关闭不再需要的文件描述符
6) 某些守护进程打开/dev/null，任何一个试图读写0 1 2都不会有任何效果

##3 出错记录 -- syslog
产生日志消息的方法：
	A 内核例程可以调用log函数。任何一个用户进程都可以打开并读取/dev／klog文件来读取消息
	B 大多数的守护进程调用syslog函数来产生日志消息
	C 将日志消息发向UDP端口514，可以进行显式的网络编程
	D syslog守护进程读取所有3中格式的日志消息  配置文件/etc/syslog.conf--决定不同种类的消息应送往何处
syslog() openlog() closelog() setlogmask()

##4 单实例守护进程	-- 文件记录锁机制

##5 守护进程的惯例
	A 如果守护进程使用文件锁，那么守护进程通常存放在/var/run中，锁文件名字name.pid
	B 如果守护进程支持配置选项，配置文件在/etc下，名字name.conf
	C 守护进程可以用shell命令启动，但通常都是由系统初始化脚本启动/etc/rc* /etc/init.d/*
	D 如果守护进程有一个配置文件，启动时读该文件·
