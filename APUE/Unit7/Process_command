#include "../include/apue.h"
#include <setjmp.h>

/*#######################################*/
/* Macros */
#define TOK_ADD 5

/*######################################*/
/* Local functions Declaration */
static void do_line(char *);
static void cmd_add(void);
static int get_token(void);

/*######################################*/
/* Global Vars*/
char *tok_ptr;
jmp_buf jumpbuffer;

int main(int argc, char const *argv[]) {
  /* code */
  char line[MAXLINE];

  if (setjmp(jumpbuffer) != 0) {
    /* code */
    printf("error");
  }

  while (fgets(line, MAXLINE, stdin))
    do_line(line);
  return 0;
}

/*#######################################*/

static void do_line(char *ptr) {
  int cmd;

  tok_ptr = ptr;
  while ((cmd = get_token()) > 0) {
    switch (cmd) { /* one case for each command */
    case TOK_ADD:
      cmd_add();
      break;
    }
  }
}

static void cmd_add(void) {
  int token;
  token = get_token();

  if (token < 0) { /* Detect an error */
    /* code */
    longjmp(jumpbuffer, 1);
  }
  /* rest of processing for this command */
}

int get_token(void) { /* fetch next token form line pointed to by tok_ptr */
}
